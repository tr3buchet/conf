#!/usr/bin/python
import subprocess
import sys


def git(*args):
    r = subprocess.check_output(['/usr/bin/git'] + list(args))
    return r.strip().split('\n')


try:
    branches = git('branch')
except subprocess.CalledProcessError:
    print 'probably not a git branch'
    sys.exit(1)

longest = len(max(branches, key=len))
for branch in branches:
    active = '*' if branch[0] == '*' else ''
    branch = branch.lstrip(' *')
    try:
        desc = git('config', 'branch.'+branch+'.description')[0]
    except subprocess.CalledProcessError:
        print '{:2}{}'.format(active, branch)
    else:
        print '{:2}{:{}}  {}'.format(active, branch, longest, desc)
